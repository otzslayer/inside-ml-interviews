# Q4.30 랭킹 모델 예측값 보정

> [!Tip]
>
> 🙋  모델 예측값을 보정해야 한다면 어떻게 하나요?

-   소비자향 추천이나 검색 랭킹 문제에서는 일반적으로 모델의 예측 점수로 아이템의 순위를 결정
-   온라인 광고
    -   광고 플랫폼은 광고 클릭이나 노출에 따라 광고주에게 비용 청구
        -   광고주는 특정한 전환<sup>conversion</sup> 이벤트를 유도하는 등의 다른 목표를 가질 수 있음
        -   Understanding bidding basics - Google Ads Help. (n.d.). Google Support. Retrieved August 5, 2024, from https://support.google.com/google-ads/answer/2459326?hl=en
    -   따라서 청구 기준과 광고주의 목표 간 불일치 발생할 수 있음
        -   광고주는 전환 이벤트를 기준으로 입찰
        -   광고 비용은 노출 기준으로 청구
    -   이런 경우 모델이 예측한 총 참여 수가 모든 광고 제품의 실제 참여 수와 거의 일치하도록 예측을 보정해야 함
-   랭킹 모델이 학습 데이터에 대해 이론적으로 잘 보정되더라도 프로덕션 환경에서 잘 보정되지 않는 이유
    -   Cross entropy 기준의 보정은 학습 중 확인된 데이터에만 해당됨
        -   따라서 본 적 없는 데이터에 대해 보정 문제와 성능 저하가 발생할 수 있음
    -   Cross entropy가 아닌 손실 함수로 학습된 경우 이론적 보정 효과가 동일하지 않음
        -   프로덕션 환경에서 보정하기가 더욱 어령무
    -   여러 광고주가 동일한 게재 위치에 입찰하는 경우 입찰가와 관련성 점수의 조함이 가장 좋은 광고가 선택됨
        -   랭킹 모델 관점에서는 경매 승자의 점수가 다른 후보보다 상당히 높은 경우가 있음
        -   선택된 후보 점수에 이러한 이상치가 있다면 결과적으로 모델이 과보정<sup>over-calibrated</sup>됨
-   보정 레이어를 사용해 프로덕션 환경에서 잘 보정되도록 할 수 있음
    -   플랫 스케일링<sup>Platt scaling</sup>
        -   랭킹 모델에서 생성된 예측 점수에 로지스틱 회귀 모델을 적용
    -   등장성 회귀<sup>Isotonic regression</sup>
        -   비모수적 계단 함수<sup>Non-parametric piecewise-constant function</sup>를 예측 점수에 적용
        -   각 구간의 높이는 보정 데이터셋의 실제 점수와 예측 점수 간의 차이 제곱의 합을 최소화하도록 선택됨